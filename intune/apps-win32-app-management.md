---
title: 將 Win32 應用程式新增至 Microsoft Intune
titlesuffix: ''
description: 了解如何使用 Microsoft Intune 來新增、傳遞及管理 Win32 應用程式。 本主題提供 Intune Win32 應用程式傳遞和管理功能的概觀，以及 Win32 應用程式疑難排解資訊。
keywords: ''
author: Erikre
ms.author: erikre
manager: dougeby
ms.date: 10/23/2018
ms.topic: article
ms.prod: ''
ms.service: microsoft-intune
ms.technology: ''
ms.assetid: efdc196b-38f3-4678-ae16-cdec4303f8d2
ms.reviewer: mghadial
ms.suite: ems
ms.custom: intune-azure
ms.openlocfilehash: d5a678e76db516034c8b6d20d58855fd281f31f8
ms.sourcegitcommit: 604b29c480b24270b5debc3e5f3141c8149ee6ed
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/24/2018
ms.locfileid: "49959582"
---
# <a name="intune-standalone---win32-app-management-public-preview"></a>Intune Standalone - Win32 應用程式管理 (公開預覽)

Intune standalone 可提供更強大的 Win32 應用程式管理功能。 雖然雲端連線使用者可以使用設定管理員進行 Win32 應用程式管理，僅使用 Intune 的客戶將可針對其 Win32 企業營運系統 (LOB) 應用程式取得更強大的管理功能。 本主題提供 Intune Win32 應用程式管理功能的概觀及疑難排解資訊。

## <a name="prerequisites-for-public-preview"></a>公開預覽的必要條件

- Windows 10 版本 1607 或更新版本 (企業版)
- Windows 10 用戶端必須： 
    - 加入 Azure Active Directory (AAD) 或混合式 Azure Active Directory，並
    - 在 Intune (MDM 受控) 中註冊
- 公開預覽中，Windows 應用程式的大小上限為每個應用程式 2 GB 

> [!NOTE]
> 我們目前正在測試 Windows 10 版本 1607 專業版和教育版，並且樂於聆聽您的意見反應。


## <a name="prepare-the-win32-app-content-for-upload"></a>準備要上傳的 Win32 應用程式內容

使用 [Microsoft Intune Win32 App Upload Prep Tool](https://github.com/Microsoft/Intune-Win32-App-Packaging-Tool) (Microsoft Intune Win32 應用程式上傳準備工具) 來預先處理 Win32 應用程式。 封裝工具會將應用程式安裝檔案轉換成 *.intunewin* 格式。 封裝工具也會偵測一部分的 Intune 必要屬性，來判斷應用程式安裝狀態。 在您於應用程式安裝程式資料夾上使用此工具後，您便可以在 Intune 主控台中建立 Win32 應用程式。

您可以從 GitHub 下載 [Microsoft Intune Win32 App Upload Prep Tool](https://github.com/Microsoft/Intune-Win32-App-Packaging-Tool) (Microsoft Intune Win32 應用程式上傳準備工具)。

### <a name="available-command-line-parameters"></a>可用命令列參數 

|    **命令列參數**    |    **描述**    |
|:------------------------------:|:----------------------------------------------------------:|
|    `-h`     |    [說明]    |
|    `-c <setup_folder>`     |    所有安裝程式檔案的安裝程式資料夾。    |
|   ` -s <setup_file>`     |    安裝程式檔案 (例如 *setup.exe* 或 *setup.msi*)。    |
|    `-o <output_folder>`     |    產生 *.intunewin* 檔案的輸出資料夾。    |
|    `-q`       |    安靜模式    |

### <a name="example-commands"></a>範例命令

|    **範例命令**    |    **描述**    |
|:-----------------------------------------------------------------------------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|    `IntuneWinAppUtil -h`    |    此命令會顯示工具的使用方式資訊。    |
|    `IntuneWinAppUtil -c <setup_folder> -s <source_setup_file> -o <output_folder> <-q>`    |    此命令會從指定來源資料夾和安裝程式檔案產生 `.intunewin` 檔案。 針對 MSI 安裝程式檔案，此工具會擷取 Intune 的必要資訊。 若指定 `-q`，則命令會在安靜模式中執行，並且若已存在輸出檔案，則該檔案將會遭到覆寫。 此外，若輸出資料夾不存在，則會自動建立資料夾。    |

## <a name="create-assign-and-monitor-a-win32-app"></a>建立、指派和監視 Win32 應用程式

與企業營運系統 (LOB) 應用程式相似，您可以將 Win32 應用程式新增至 Microsoft Intune。 此類型應用程式通常是在由內部編寫或由協力廠商編寫。 下列步驟可提供指導，協助您將 Windows 應用程式新增至 Intune。

### <a name="step-1-specify-the-software-setup-file"></a>步驟 1：指定軟體安裝檔

1.  登入 [Azure 入口網站](https://portal.azure.com/)。
2.  選取 [所有服務] > [Intune]。 Intune 位於 [監視 + 管理] 區段。
3.  在 [Intune] 窗格中，選取 [用戶端應用程式]  > [應用程式]  > [新增]。
4.  在 [新增] 應用程式窗格中，從提供的下拉式清單中選取 [Windows 應用程式 (Win32) - 公開預覽]。

    ![新增應用程式螢幕擷取畫面 - 新增類型下拉式方塊](./media/apps-win32-app-01.png)

### <a name="step-2-upload-the-app-package-file"></a>步驟 2：上傳應用程式套件檔案

1.  在 [新增應用程式] 窗格中，選取 [新增套件檔案] 來選取檔案。 應用程式套件檔案窗格隨即顯示。

    ![螢幕擷取畫面 應用程式套件檔案](./media/apps-win32-app-02.png)

2.  在 [應用程式套件檔案] 窗格中，選取 [瀏覽] 按鈕。 然後，選取副檔名為 *.intunewin* 的 Windows 安裝檔案。
3.  完成後，按一下 [確定]。

### <a name="step-3-configure-app-information"></a>步驟 3：設定應用程式資訊

1.  在 [新增應用程式] 窗格中，選擇 [應用程式資訊] 來設定應用程式。
2.  在 [應用程式資訊] 窗格中，設定下列資訊。 窗格中某些值可能會自動填入。
    - **名稱**：輸入會在公司入口網站中顯示的應用程式名稱。 如果有重複的應用程式名稱，每個應用程式都會出現在公司入口網站中。
    - **描述**：輸入應用程式的描述。 此描述會出現在公司入口網站上。
    - **發行者**：輸入應用程式發行者的名稱。
    - **類別**：選取一或多個內建應用程式類別，或選取您建立的類別。 類別可以讓使用者在瀏覽公司入口網站時，更輕鬆地找到應用程式。
    - **將此顯示為公司入口網站中的精選應用程式**：當使用者瀏覽應用程式時，以醒目方式在公司入口網站的主頁面上顯示此應用程式。
    - **資訊 URL**：選擇是否輸入包含此應用程式相關資訊的網站 URL。 此 URL 會出現在公司入口網站上。
    - **隱私權 URL**：選擇是否輸入包含此應用程式隱私權資訊的網站 URL。 此 URL 會出現在公司入口網站上。
    - **開發人員**：選擇是否要輸入應用程式開發人員的姓名。
    - **擁有者**：選擇是否要輸入此應用程式的擁有者名稱。 **人力資源部門**就是一個例子。
    - **附註**：輸入要與此應用程式相關聯的任何附註。
    - **標誌**：上傳將與應用程式建立關聯的圖示。 這是使用者瀏覽公司入口網站時，會隨應用程式一起顯示的圖示。
3.  完成後，按一下 [確定]。

### <a name="step-4-configure-app-installation-details"></a>步驟 4：設定應用程式安裝詳細資料
1.  在 [新增應用程式] 窗格中，選取 [程式] 來設定應用程式安裝和應用程式的移除命令。
2.  新增完整安裝命令來安裝應用程式。 

    例如，若您的應用程式檔案名稱為 **MyApp123**，請新增下列內容：`msiexec /i “MyApp123.msi”`

3.  新增完整解除安裝命令，來根據應用程式的 GUID 解除安裝應用程式。 

    例如：`msiexec /x “{12345A67-89B0-1234-5678-000001000000}”`

4.  完成後，按一下 [確定]。

### <a name="step-5-configure-app-requirements"></a>步驟 5：設定應用程式需求

1.  在 [新增應用程式] 窗格中，選取 [需求] 來設定裝置在安裝應用程式之前必須滿足的需求。
2.  在 [需求] 窗格中，設定下列資訊。 窗格中某些值可能會自動填入。
    - **作業系統架構**：選擇安裝應用程式所需要的架構。
    - **最低作業系統**：選取安裝應用程式所需要的最低作業系統。
    - **必要磁碟空間 (MB)**：選擇性，新增安裝應用程式時，系統磁碟上所需要的可用磁碟空間。
    - **必要實體記憶體 (MB)**：選擇性，新增安裝應用程式所需要的實體記憶體 (RAM)。
    - **必要最低邏輯處理器數**：選擇性，新增安裝應用程式所需要的最低邏輯處理器數目。
    - **必要最低 CPU 速度 (MHz)**：選擇性，新增安裝應用程式所需要的最低 CPU 速度。
3.  完成後，按一下 [確定]。

### <a name="step-6-configure-app-detection-rules"></a>步驟 6：設定應用程式偵測規則

1.  在 [新增應用程式] 窗格中，選取 [偵測規則]，設定要偵測應用程式是否存在的規則。
2.  在 [規則格式] 欄位中，選取偵測應用程式是否存在的方式。 您可以選擇手動設定偵測規則，或是使用自訂指令碼來偵測應用程式是否存在。 您至少必須選擇一個偵測規則。 

    > [!NOTE]
    > 在 [偵測規則] 窗格中，您可以選擇新增多個規則。 必須符合**所有**規則的條件，才能偵測應用程式。

    - **手動設定偵測規則** – 您可以選取下列其中一個規則類型：
        1.  **MSI** – 根據 MSI 版本檢查進行驗證。 此選項只能新增一次。 當您選擇此規則類型時，您有兩個設定：
            - **MSI 產品代碼**  – 新增應用程式的有效 MSI 產品代碼。
            - **MSI 產品版本檢查** – 選取 [是] 來在驗證 MSI 產品代碼的同時驗證 MSI 產品版本。
        2.  **檔案** – 根據檔案或資料夾偵測、日期、版本或大小進行驗證。
            - **路徑**  – 包含要偵測檔案或資料夾的資料夾完整路徑。
            - **檔案或資料夾** – 要偵測的檔案或資料夾。
            - **偵測方法** – 選取要用於驗證應用程式是否存在的偵測方法類型。
            - **在 64 位元用戶端上與 32 位元應用程式建立關聯** – 選取 [是] 來在 64 位元用戶端上展開 32 位元內容裡的任何路徑環境變數。 選取 [否] 來在 64 位元用戶端上展開 64 位元內容裡的任何路徑變數 (預設值)。 32 位元用戶端一律會使用 32 位元內容。
            
            **檔案型偵測範例**
            1.  檢查檔案是否存在。
         
                ![偵測規則窗格的螢幕擷取畫面 - 檔案存在](./media/apps-win32-app-03.png)
        
            2.  檢查資料夾是否存在。
         
                ![偵測規則窗格的螢幕擷取畫面 - 資料夾存在](./media/apps-win32-app-04.png)
        
        3. **登錄** – 根據值、字串、整數或版本進行驗證。
            - **機碼路徑** – 包含要偵測值的登錄項目完整路徑。
            - [Value name]**值名稱** – 要偵測的登錄值名稱。 若此值空白，則會對機碼進行偵測。 若偵測方法是檔案或資料夾存在性以外的方法，則會使用機碼的 (預設) 值。
            - **偵測方法** – 選取要用於驗證應用程式是否存在的偵測方法類型。
            - **在 64 位元用戶端上與 32 位元應用程式建立關聯** - 選取 [是] 來在 64 位元用戶端上搜尋 32 位元登錄。 選取 [否] 來在 64 位元用戶端上搜尋 64 位元登錄 (預設值)。 32 位元用戶端一律會搜尋 32 位元登錄。
            
            **登錄型偵測範例**
            1.  檢查登錄機碼是否存在。
            
                ![偵測規則窗格的螢幕擷取畫面 - 登錄機碼存在](./media/apps-win32-app-05.png)    
            
            2.  檢查登錄值是否存在 (**公開預覽中無法使用**)。
        
                ![偵測規則窗格的螢幕擷取畫面 - 登錄值存在](./media/apps-win32-app-06.png)    
        
            3.  檢查登錄值字串是否相等。
        
                ![偵測規則窗格的螢幕擷取畫面 - 登錄字串相等](./media/apps-win32-app-07.png)    
     
    - **使用自訂偵測指令碼** – 指定要用於偵測應用程式的 PowerShell 指令碼。 
    
        1.  **指令碼檔案** – 選取將偵測用戶端上是否存在應用程式的 PowerShell 指令碼。 當指令碼傳回 0 值結束代碼，並將字串值寫入 STDOUT 時，便會偵測到應用程式。
        2.  **在 64 位元用戶端上作為 32 位元處理序執行** – 選取 [是] 來使用登入終端使用者的認證執行指令碼。 選取 [否] 來在系統內容中執行指令碼 (預設值)。
        3.  [Enforce script signature check]**強制指令碼簽章檢查** – 選取 [是] 來驗證指令碼是否是由信任的發佈者簽署，允許指令碼在不顯示警告或提示的情況下執行指令碼。 指令碼會在解除封鎖的情況下執行。 選取 [否] 來在不進行簽章驗證的情況下，透過終端使用者確認來執行指令碼 (預設值)。
    
        Intune Sidecar 會檢查指令碼的結果。 它會讀取指令碼寫入到標準輸出 (STDOUT) 串流、標準錯誤 (STDERR) 串流及結束代碼的值。 如果指令碼以非零值結束，代表指令碼執行失敗，且應用程式偵測狀態為未安裝。 如果結束代碼為零而 STDOUT 含有資料，表示應用程式偵測狀態是「已安裝」。 
    
        > [!NOTE]
        > 當指令碼以 0 值結束時，指令碼執行便已成功。 第二個輸出通道表示已偵測到應用程式 - STDOUT 指出已在用戶端上找到應用程式。 我們並非要在 STDOUT 中尋找特定字串。
    
3.  當您新增完您的規則之後，請選取 [新增] \(\) > [確認] \(\)。

### <a name="step-7-configure-app-return-codes"></a>步驟 7：設定應用程式傳回碼

1.  在 [新增應用程式] 窗格中，選取 [傳回碼] 來新增用來指定應用程式安裝重試行為或安裝後續行為的傳回碼。 根據預設，傳回碼項目會在應用程式建立時新增。 但是，您可以新增額外的傳回碼或變更現有傳回碼。 
2.  在 [傳回碼] 窗格中，新增額外傳回碼，或是修改現有傳回碼。
    - **失敗** – 傳回值，表示應用程式安裝失敗。
    - **強制重新開機** – 強制重新開機傳回碼不允許下一個 Win32 應用程式在用戶端重新開機前進行安裝。 
    - **軟開機** – 軟開機傳回代碼允許下一個 Win32 應用程式在用戶端無須重新開機的情況下進行安裝。 重新開機之後才能完成安裝目前的應用程式。
    - **重試** – 重試傳回代碼代理程式會嘗試安裝應用程式三次。 它會在每一次的嘗試之間等待 5 分鐘。 
    - **成功** – 傳回值，表示應用程式安裝成功。
3.  當您新增或修改完您的傳回代碼清單後，請選取 [確認]。

### <a name="step-8-add-the-app"></a>步驟 8：新增應用程式

1.  在 [新增應用程式] 窗格中，確認您所設定的應用程式資訊正確無誤。
2.  選取 [新增]，將應用程式上傳至 Intune。

### <a name="step-9-assign-the-app"></a>步驟 9：指派應用程式

1.  在應用程式窗格中，選取 [指派]。
2.  選取 [新增群組]，以開啟和應用程式相關的 [新增群組] 窗格。
3.  針對特定的應用程式，選取 [指派類型]：
    - **可透過已註冊裝置使用**：使用者從公司入口網站應用程式或公司入口網站中安裝應用程式。
    - **必要**：此應用程式會安裝在所選群組中的裝置上。
    - **解除安裝**：此應用程式會從所選群組中的裝置上解除安裝。
4.  選取 [包含群組]，然後指派會使用此應用程式的群組。
5.  在 [指派] 窗格中，選取 [確定] 來完成包含群組選取項目。
6.  如果您想要將任何使用者群組排除，使他們不受此應用程式指派影響，請選取 [排除群組]。
7.  在 [新增群組] 窗格中，選取 [確定]。
8.  在應用程式 [指派] 窗格中，選取 [儲存]。

此時，您已完成將 Win32 應用程式新增至 Intune 的步驟。 如需應用程式指派和監視的資訊，請參閱[使用 Microsoft Intune 指派應用程式給群組](https://docs.microsoft.com/intune/apps-deploy)和[使用 Microsoft Intune 監視應用程式資訊和指派](https://docs.microsoft.com/intune/apps-monitor)。

## <a name="install-required-and-available-apps-on-devices"></a>在裝置上安裝必要和可用應用程式

終端使用者會看到必要及可用應用程式安裝的 Windows 快顯通知。 下列影像顯示快顯通知範例，其中表示裝置必須重新啟動，才能完成應用程式安裝。 

![應用程式安裝 Windows 快顯通知的螢幕擷取畫面範例](./media/apps-win32-app-08.png)    

下列影像會通知終端使用者即將將應用程式變更套用到裝置。

![通知終端使用者即將將應用程式變更套用到裝置的螢幕擷取畫面範例](./media/apps-win32-app-09.png)    

## <a name="troubleshoot-win32-app-issues"></a>針對 Win32 應用程式問題進行疑難排解
用戶端電腦上的代理程式記錄通常位於 `C:\ProgramData\Microsoft\IntuneManagementExtension\Logs`。 您可以利用 `CMTrace.exe` 檢視這些記錄檔。 *CMTrace.exe* 可從 [SCCM Client Tools](https://docs.microsoft.com/sccm/core/support/tools) (SCCM 用戶端工具) 下載。 

![代理程式記錄的螢幕擷取畫面](./media/apps-win32-app-10.png)    

### <a name="troubleshooting-areas-to-consider"></a>應考慮的疑難排解區域
- 檢查目標，確認代理程式已安裝在裝置上 - 目標為群組的 Win32 應用程式，或是目標為群組的 PowerShell 指令碼會建立安全性群組的代理程式安裝原則。
- 檢查 OS 版本 – Windows 10 1607 或更新版本。  
- AAD 使用者是否已登入用戶端電腦？
- 檢查 Windows 10 SKU - Windows 10 S 或在啟用 S 模式的情況下執行的 Windows 版本不支援 MSI 安裝。

## <a name="next-steps"></a>接下來的步驟

- 如需將應用程式新增至 Intune 的詳細資訊，請參閱[將應用程式新增至 Microsoft Intune](apps-add.md)。
